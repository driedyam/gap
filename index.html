<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Google Analytics automatic Push (GAP) - Automatic tracking of user behavior via Google Analytics</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Google Analytics automatic Push (GAP)</h1>
        <p class="header">Automatic tracking of user behavior via Google Analytics.</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/rockymadden/gap/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/rockymadden/gap/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/rockymadden/gap">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="http://rockymadden.com/">Rocky Madden</a></p>


      </header>
      <section><h2>Overview</h2>
        <p>Dead simple wrapper around the Google Analytics API which provides automatic tracking of user behaviors via events. Want to see the event tracking in action? Open up your JavaScript console.</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>There is no need to include any of the default Google Analytics tracking code, as GAP takes care of all this for you. Simply <a href="https://raw.github.com/rockymadden/gap/master/gap.min.js">download the gap.min.js</a> file, place on your server, and update the noted fields below. That's it!</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">_gap</span> <span class="o">=</span> <span class="nx">_gap</span> <span class="o">||</span> <span class="p">[];</span>

<span class="c1">// Standard Google Analytics pushes, just with _gap.push. </span>
<span class="c1">// You can push anything, just like normal, via _gap.push instead of _gaq.push.</span>
<span class="nx">_gap</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s2">"_setAccount"</span><span class="p">,</span> <span class="s2">"UA-XXXXXX-X"</span><span class="p">]);</span> <span class="c1">// CHANGE.</span>
<span class="nx">_gap</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s2">"_trackPageview"</span><span class="p">]);</span>

<span class="c1">// With both bounce trackers active, any user who scrolls down 50%</span>
<span class="c1">// OR stays 10 seconds is not counted as a bounce. You can use just one too.</span>
<span class="nx">_gap</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s2">"_gapTrackBounceViaTime"</span><span class="p">,</span> <span class="mi">10</span><span class="p">]);</span> <span class="c1">// Change seconds, if needed.</span>
<span class="nx">_gap</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s2">"_gapTrackBounceViaScroll"</span><span class="p">,</span> <span class="mi">50</span><span class="p">]);</span> <span class="c1">// Change percentage, if needed.</span>

<span class="c1">// Every 20 seconds, push a read event so that time on site is more accurate.</span>
<span class="c1">// Only allow 30 of these read events per page.</span>
<span class="nx">_gap</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s2">"_gapTrackReads"</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]);</span> <span class="c1">// Change cadence and max read events per page, if needed.</span>

<span class="c1">// Anytime a user clicks a link, internal or external, push the event.</span>
<span class="nx">_gap</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s2">"_gapTrackLinkClicks"</span><span class="p">]);</span>

<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">gap</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"script"</span><span class="p">);</span>
    <span class="nx">gap</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">gap</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">"text/javascript"</span><span class="p">;</span>
    <span class="nx">gap</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">"/js/gap.min.js"</span><span class="p">;</span> <span class="c1">// CHANGE.</span>

    <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"script"</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="nx">s</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">gap</span><span class="p">,</span> <span class="nx">s</span><span class="p">);</span>
<span class="p">})();</span>
</pre></div>

<h2>
<a name="trackers" class="anchor" href="#trackers"><span class="octicon octicon-link"></span></a>Trackers</h2>

<p><strong>gapTrackBounceViaScroll</strong></p>

<p>Logs a single <code>gapBounceViaScroll</code> event after scrolling n percentage down the page. This event will only fire once per session.</p>

<p>If you do not consider users who fully scroll (to your specified requirement) down your page a bounce, this tracker can help you. The default implementation of the Google Analytics tracking code has some undesirable traits. The following scenarios help illustrate: </p>

<ul>
<li>User A arrives on your website. He finds a wealth of information he is looking for on the first landing page. He fully scrolls/reads the entire page and then departs. By default, this is considered a bounce.</li>
<li>More information on this subject, <a href="http://analytics.blogspot.com/2012/07/tracking-adjusted-bounce-rate-in-google.html">straight from Google</a>.</li>
</ul><div class="highlight"><pre><span class="nx">_gap</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span>
    <span class="s2">"_gapTrackBounceViaScroll"</span><span class="p">,</span>
    <span class="mi">50</span> <span class="c1">// Percentage of the page scrolled before this user is not considered a bounce.</span>
<span class="p">]);</span>
</pre></div>

<hr><p><strong>gapTrackBounceViaTime</strong></p>

<p>Logs a single <code>gapBounceViaTime</code> event after n seconds. This event will only fire once per session.</p>

<p>If you do not consider users who spend long durations on their first and only page visit on your website a bounce, this tracker can help you. The default implementation of the Google Analytics tracking code has some undesirable traits. The following scenarios help illustrate: </p>

<ul>
<li>User A arrives on your website. She finds a wealth of information she is looking for on the first landing page. She spends 15 minutes reading and then departs. By default, this is considered a bounce.</li>
<li>More information on this subject, <a href="http://analytics.blogspot.com/2012/07/tracking-adjusted-bounce-rate-in-google.html">straight from Google</a>.</li>
</ul><div class="highlight"><pre><span class="nx">_gap</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span>
    <span class="s2">"_gapTrackBounceViaTime"</span><span class="p">,</span>
    <span class="mi">10</span> <span class="c1">// Number of seconds before this user is not considered a bounce.</span>
<span class="p">]);</span>
</pre></div>

<hr><p><strong>gapTrackReads</strong></p>

<p>Logs <code>gapRead</code> events every n seconds. Each new event label is updated as time progresses. For instance, with a 10 second cadence the first event label would be 10, the second would be 20, and so on.</p>

<p>If you are puzzled as to why so many of your users have a time on site of 0 seconds, this tracker can help you. If you want to accurately test changes to your website and how they truly affect user engagement, this tracker can help you. The default implementation of the Google Analytics tracking code has some undesirable traits. The following scenarios help illustrate: </p>

<ul>
<li>User A arrives on your website. He finds a wealth of information he is looking for on the first landing page. He spends 5 minutes reading and then departs. By default, the time on site for this user is 0 seconds.</li>
<li>User B arrives on your website. He doesn't find what he is looking for on the first page, so 10 seconds after arriving he lands on the second, and final, page of his visit. He finds a wealth of information, and he spends 30 minutes reading and then departs. By default, the time on site for this user is 10 seconds.</li>
<li>You have redesigned your website hoping to improve user engagement (e.g. increase time on site and lower bounce rate). Because you used the default implementation of the Google Analytics code, your bounce rate is over stated and your time on site is under stated. After the redesign, you see positive numbers on both these fronts. Bounce rate is down and time on site is up. Both these data points are not only incorrect, but the opposite could be true. Your time on site could, in actuality, be lower than before. Your bounce rate could, in actuality, be higher than before.</li>
<li>More information on this subject, <a href="http://analytics.blogspot.com/2012/07/tracking-adjusted-bounce-rate-in-google.html">straight from Google</a>.</li>
</ul><p>Polling cadence can be changed as well as the number of events total this tracker can utilize per page. There is a limit of <a href="https://developers.google.com/analytics/devguides/collection/gajs/limits-quotas">500 total events tracked per session</a>, so keep this in mind.</p>

<div class="highlight"><pre><span class="nx">_gap</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span>
    <span class="s2">"_gapTrackReads"</span><span class="p">,</span>
    <span class="mi">20</span><span class="p">,</span> <span class="c1">// Polling cadence, in seconds.</span>
    <span class="mi">30</span> <span class="c1">// Maximum number of these events tracked per page.</span>
<span class="p">]);</span>
</pre></div>

<hr><p><strong>gapTrackLinkClicks</strong></p>

<p>Logs <code>a</code> and <code>button</code> mousedown events (i.e. user clicks) via event delegation. Event action logged is <code>gapLinkClick</code>. Event label logged is <code>#{linkName} (#{linkURL})</code>.</p>

<div class="highlight"><pre><span class="nx">_gap</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s2">"_gapTrackLinkClicks"</span><span class="p">]);</span>
</pre></div>

<h2>
<a name="versioning" class="anchor" href="#versioning"><span class="octicon octicon-link"></span></a>Versioning</h2>

<p><a href="http://semver.org/">Semantic Versioning v2.0</a></p>

<h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p><a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License v2.0</a></p>
      </section>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
<script type="text/javascript">
var _gap = _gap || [];
_gap.push(["_setAccount", "UA-20432336-1"]); // CHANGE.
_gap.push(["_trackPageview"]);
_gap.push(["_gapTrackBounceViaTime", 10]);
_gap.push(["_gapTrackBounceViaScroll", 50]);
_gap.push(["_gapTrackReads", 20, 30]);
_gap.push(["_gapTrackLinkClicks"]);
_gapDebug = true;

(function() {
    var gap = document.createElement("script");
    gap.async = true;
    gap.type = "text/javascript";
    gap.src = "http://rockymadden.com/js/gap.min.js"; // CHANGE.

    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(gap, s);
})();

  </body>
</html>
